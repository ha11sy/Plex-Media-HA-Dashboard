# Plex Media Dashboard Template
# Replace all placeholders marked with YOUR_* with your actual values
# See SETUP_GUIDE.md for detailed instructions

title: Media
theme: ios-dark-mode-blue-red  # Change to your preferred theme
background: var(--background-image)
views:
  - title: Media
    path: media
    type: custom:grid-layout
    layout:
      grid-template-columns: 22% 52% 26%
      grid-template-rows: auto
      grid-gap: 10px
      mediaquery:
        '(max-width: 1200px)':
          grid-template-columns: 30% 70%
        '(max-width: 800px)':
          grid-template-columns: 100%
    cards:
      # ===========================================
      # TOP STATUS BAR - Optional statistics
      # Comment out sensors you don't have
      # ===========================================
      - type: horizontal-stack
        view_layout:
          grid-column: 1 / -1
        cards:
          # Active Plex Streams (requires Plex integration)
          - type: custom:button-card
            entity: sensor.plex_active_streams  # CHANGE: Your Plex sensor
            name: User Sessions
            show_state: false
            show_label: true
            label: >
              [[[ return `${states['sensor.plex_active_streams'].state}
              Sessions`; ]]]
            icon: mdi:account-group
            styles:
              card:
                - background: >-
                    linear-gradient(135deg, rgba(255, 159, 9, 0.2) 0%, rgba(255,
                    159, 9, 0.05) 100%)
                - border-radius: 15px
                - padding: 15px
                - border: 1px solid rgba(255, 159, 9, 0.3)
              grid:
                - grid-template-areas: '"i" "n" "l"'
                - grid-template-columns: 1fr
                - grid-template-rows: 1fr min-content min-content
              icon:
                - width: 35px
                - color: rgba(255, 159, 9, 1)
              name:
                - font-size: 9px
                - color: rgba(255, 255, 255, 0.5)
                - text-transform: uppercase
                - margin-top: 8px
              label:
                - font-size: 16px
                - font-weight: bold
                - color: white
          
          # Overseerr Pending Requests (optional - comment out if not using Overseerr)
          - type: custom:button-card
            entity: sensor.overseerr_pending_requests  # CHANGE or COMMENT OUT
            name: Pending Requests
            show_state: false
            show_label: true
            label: >
              [[[ return `${states['sensor.overseerr_pending_requests'].state}
              requests`; ]]]
            icon: mdi:clock-outline
            styles:
              card:
                - background: >-
                    linear-gradient(135deg, rgba(255, 214, 10, 0.2) 0%,
                    rgba(255, 214, 10, 0.05) 100%)
                - border-radius: 15px
                - padding: 15px
                - border: 1px solid rgba(255, 214, 10, 0.3)
              grid:
                - grid-template-areas: '"i" "n" "l"'
                - grid-template-columns: 1fr
                - grid-template-rows: 1fr min-content min-content
              icon:
                - width: 35px
                - color: rgba(255, 214, 10, 1)
              name:
                - font-size: 9px
                - color: rgba(255, 255, 255, 0.5)
                - text-transform: uppercase
                - margin-top: 8px
              label:
                - font-size: 16px
                - font-weight: bold
                - color: white
          
          # Radarr Movie Count (optional - comment out if not using Radarr)
          - type: custom:button-card
            entity: sensor.radarr_movies  # CHANGE or COMMENT OUT
            name: Movies
            icon: mdi:movie-roll
            show_state: false
            show_label: true
            label: |
              [[[ return `${states['sensor.radarr_movies'].state}`; ]]]
            styles:
              card:
                - background: >-
                    linear-gradient(135deg, rgba(10, 132, 255, 0.2) 0%, rgba(10,
                    132, 255, 0.05) 100%)
                - border-radius: 15px
                - padding: 15px
                - border: 1px solid rgba(10, 132, 255, 0.3)
              grid:
                - grid-template-areas: '"i" "n" "l"'
                - grid-template-columns: 1fr
                - grid-template-rows: 1fr min-content min-content
              icon:
                - width: 35px
                - color: rgba(10, 132, 255, 1)
              name:
                - font-size: 9px
                - color: rgba(255, 255, 255, 0.5)
                - text-transform: uppercase
                - margin-top: 8px
              label:
                - font-size: 16px
                - font-weight: bold
                - color: white

      # ===========================================
      # LEFT SIDEBAR - Player Selection & Navigation
      # ===========================================
      - type: custom:vertical-stack-in-card
        view_layout:
          grid-column: 1
          grid-row: 2
        card_mod:
          style: |
            ha-card {
              background: rgba(10, 10, 10, 0.5) !important;
              border-radius: 20px !important;
              height: calc(100vh - 160px) !important;
              overflow-y: auto !important;
            }
            ::-webkit-scrollbar { width: 0px; background: transparent; }
        cards:
          # Player Selection Buttons
          - type: custom:mushroom-title-card
            title: ðŸŽ¯ Play On
            subtitle: Select target device
            card_mod:
              style: >
                ha-card { background: transparent !important; box-shadow: none
                !important; margin-bottom: -10px !important; }
          
          - type: grid
            columns: 2
            square: false
            gap: 8px
            cards:
              # PLAYER 1 - CHANGE: Entity ID, name, and icon
              - type: custom:button-card
                name: Living Room  # CHANGE: Your room name
                icon: mdi:television  # CHANGE: Your preferred icon
                tap_action:
                  action: call-service
                  service: input_select.select_option
                  data:
                    entity_id: input_select.plex_active_player
                    option: media_player.living_room_tv  # CHANGE: Your entity ID
                state:
                  - operator: template
                    value: >-
                      [[[ return states['input_select.plex_active_player'].state
                      == 'media_player.living_room_tv' ]]]  # CHANGE: Match above
                    styles:
                      card:
                        - background: rgba(16, 124, 16, 0.8)
                        - border: 2px solid white
                      icon:
                        - color: white
                      name:
                        - color: white
                styles:
                  card:
                    - background: rgba(255, 255, 255, 0.1)
                    - border-radius: 10px
                    - padding: 10px
                    - border: 1px solid rgba(255, 255, 255, 0.2)
                    - cursor: pointer
                  icon:
                    - color: rgba(255, 255, 255, 0.8)
                  name:
                    - color: rgba(255, 255, 255, 0.8)
                  grid:
                    - grid-template-areas: '"i" "n"'
                    - grid-template-rows: 1fr min-content
              
              # PLAYER 2 - CHANGE: Entity ID, name, and icon
              - type: custom:button-card
                name: Bedroom  # CHANGE: Your room name
                icon: mdi:bed  # CHANGE: Your preferred icon
                tap_action:
                  action: call-service
                  service: input_select.select_option
                  data:
                    entity_id: input_select.plex_active_player
                    option: media_player.bedroom_tv  # CHANGE: Your entity ID
                state:
                  - operator: template
                    value: >-
                      [[[ return states['input_select.plex_active_player'].state
                      == 'media_player.bedroom_tv' ]]]  # CHANGE: Match above
                    styles:
                      card:
                        - background: rgba(94, 92, 230, 0.8)
                        - border: 2px solid white
                      icon:
                        - color: white
                      name:
                        - color: white
                styles:
                  card:
                    - background: rgba(255, 255, 255, 0.1)
                    - border-radius: 10px
                    - padding: 10px
                    - border: 1px solid rgba(255, 255, 255, 0.2)
                    - cursor: pointer
                  icon:
                    - color: rgba(255, 255, 255, 0.8)
                  name:
                    - color: rgba(255, 255, 255, 0.8)
                  grid:
                    - grid-template-areas: '"i" "n"'
                    - grid-template-rows: 1fr min-content
          
          # Library Navigation (Movies/TV Shows)
          - type: conditional
            conditions:
              - entity: input_select.media_sidebar_mode
                state: Main
            card:
              type: vertical-stack
              cards:
                - type: custom:mushroom-title-card
                  title: ðŸ§­ Browse
                  subtitle: Select Library
                  card_mod:
                    style: >
                      ha-card { background: transparent !important; box-shadow:
                      none !important; margin-top: 15px !important;}
                - type: grid
                  columns: 1
                  square: false
                  cards:
                    - type: custom:button-card
                      name: Movies
                      icon: mdi:movie-open
                      tap_action:
                        action: call-service
                        service: script.media_nav_movies_clean
                      hold_action:
                        action: call-service
                        service: script.media_nav_movies_menu
                      state:
                        - operator: template
                          value: >-
                            [[[ return
                            states['input_select.media_dashboard_view'].state ==
                            'Movies' ]]]
                          styles:
                            card:
                              - background: rgba(10, 132, 255, 0.8)
                              - border: 2px solid white
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(10, 132, 255, 0.3)
                              0%, rgba(10, 132, 255, 0.1) 100%)
                          - border-radius: 12px
                          - padding: 15px
                          - border: 1px solid rgba(10, 132, 255, 0.4)
                          - margin-bottom: 8px
                        grid:
                          - grid-template-areas: '"i n"'
                          - grid-template-columns: min-content 1fr
                        icon:
                          - color: white
                          - width: 30px
                        name:
                          - color: white
                          - font-size: 16px
                          - font-weight: bold
                          - align-self: center
                          - margin-left: 15px
                    - type: custom:button-card
                      name: TV Shows
                      icon: mdi:television-classic
                      tap_action:
                        action: call-service
                        service: script.media_nav_tv_clean
                      hold_action:
                        action: call-service
                        service: script.media_nav_tv_menu
                      state:
                        - operator: template
                          value: >-
                            [[[ return
                            states['input_select.media_dashboard_view'].state ==
                            'TV Shows' ]]]
                          styles:
                            card:
                              - background: rgba(94, 92, 230, 0.8)
                              - border: 2px solid white
                      styles:
                        card:
                          - background: >-
                              linear-gradient(135deg, rgba(94, 92, 230, 0.3) 0%,
                              rgba(94, 92, 230, 0.1) 100%)
                          - border-radius: 12px
                          - padding: 15px
                          - border: 1px solid rgba(94, 92, 230, 0.4)
                        grid:
                          - grid-template-areas: '"i n"'
                          - grid-template-columns: min-content 1fr
                        icon:
                          - color: white
                          - width: 30px
                        name:
                          - color: white
                          - font-size: 16px
                          - font-weight: bold
                          - align-self: center
                          - margin-left: 15px

          # Now Playing Cards - Shows when media is playing
          - type: custom:mushroom-title-card
            title: ðŸŽµ Now Playing
            card_mod:
              style: |
                ha-card {
                  background: transparent !important;
                  box-shadow: none !important;
                  margin-top: 25px !important;
                  display: {% if is_state('media_player.living_room_tv', 'playing') or is_state('media_player.bedroom_tv', 'playing') %} block {% else %} none {% endif %} !important;
                }
          
          # CHANGE: Entity ID for each player you have
          - type: conditional
            conditions:
              - entity: media_player.living_room_tv  # CHANGE
                state: playing
            card:
              type: custom:mini-media-player
              entity: media_player.living_room_tv  # CHANGE
              name: Playing in Living Room  # CHANGE
              artwork: full-cover
              info: scroll
              hide:
                power: false
                icon: false
                source: false
                volume: false
              controls:
                - play_pause
                - next
                - volume
              card_mod:
                style: >
                  ha-card { 
                    border-radius: 15px !important; 
                    background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.95) 100%) !important;
                    border: 1px solid rgba(16, 124, 16, 0.8) !important;
                    overflow: hidden !important;
                  }
                  .mmp__bg { opacity: 0.3 !important; }

      # ===========================================
      # CENTER AREA - Plex Content Browser
      # ===========================================
      - type: custom:vertical-stack-in-card
        view_layout:
          grid-column: 2
          grid-row: 2
        card_mod:
          style: |
            ha-card {
              background: transparent !important;
              box-shadow: none !important;
              height: calc(100vh - 160px) !important;
              overflow-y: auto !important;
            }
            ::-webkit-scrollbar { width: 0px; background: transparent; }
        cards:
          # Movies Library for Player 1
          - type: conditional
            conditions:
              - entity: input_select.plex_active_player
                state: media_player.living_room_tv  # CHANGE: Your entity ID
            card:
              type: vertical-stack
              cards:
                - type: conditional
                  conditions:
                    - entity: input_select.media_dashboard_view
                      state: Movies
                    - entity: input_select.media_filter_genre
                      state: None
                  card:
                    type: custom:plex-meets-homeassistant
                    token: YOUR_PLEX_TOKEN_HERE  # CHANGE: Your Plex token
                    ip: YOUR_PLEX_IP  # CHANGE: Your Plex server IP (e.g., 192.168.1.100)
                    port: 32400
                    libraryName: Movies  # CHANGE: Your Plex library name (must match exactly)
                    protocol: http  # Change to https if using SSL
                    sort: addedAt:desc
                    entity:
                      - media_player.living_room_tv  # CHANGE: Match player entity
                    card_mod:
                      style: |
                        ha-card { 
                          background: transparent !important;
                          box-shadow: none !important; 
                        }
                        .header ha-icon-button { 
                          color: white !important;
                          background: rgba(0,0,0,0.6) !important; 
                          border-radius: 50%; 
                          width: 40px !important; 
                          height: 40px !important;
                          z-index: 1000 !important; 
                          display: block !important;
                          opacity: 1 !important; 
                        }
                        .overview-text { 
                          pointer-events: none !important;
                          z-index: 1 !important;
                        }
                        .button-play, .play-btn, .play-button { 
                          pointer-events: auto !important;
                          z-index: 999 !important;
                          position: relative !important;
                          cursor: pointer !important;
                        }
                        .trailer-list { 
                          pointer-events: auto !important;
                          z-index: 50 !important;
                          position: relative !important;
                        }
                        .detailBottom {
                          pointer-events: auto !important;
                          z-index: 100 !important;
                        }
                
                # TV Shows Library for Player 1
                - type: conditional
                  conditions:
                    - entity: input_select.media_dashboard_view
                      state: TV Shows
                    - entity: input_select.media_filter_genre
                      state: None
                  card:
                    type: custom:plex-meets-homeassistant
                    token: YOUR_PLEX_TOKEN_HERE  # CHANGE
                    ip: YOUR_PLEX_IP  # CHANGE
                    port: 32400
                    libraryName: TV Shows  # CHANGE
                    protocol: http
                    sort: addedAt:desc
                    entity:
                      - media_player.living_room_tv  # CHANGE
                    card_mod:
                      style: |
                        ha-card { 
                          background: transparent !important;
                          box-shadow: none !important; 
                        }
                        .header ha-icon-button { 
                          color: white !important;
                          background: rgba(0,0,0,0.6) !important; 
                          border-radius: 50%; 
                          width: 40px !important; 
                          height: 40px !important;
                          z-index: 1000 !important; 
                          display: block !important;
                          opacity: 1 !important; 
                        }
                        .overview-text { 
                          pointer-events: none !important;
                          z-index: 1 !important;
                        }
                        .button-play, .play-btn, .play-button { 
                          pointer-events: auto !important;
                          z-index: 999 !important;
                          position: relative !important;
                          cursor: pointer !important;
                        }
                        .trailer-list { 
                          pointer-events: auto !important;
                          z-index: 50 !important;
                          position: relative !important;
                        }
                        .detailBottom {
                          pointer-events: auto !important;
                          z-index: 100 !important;
                        }

# ===========================================
# NOTES FOR CUSTOMIZATION:
# ===========================================
# 1. Search for "CHANGE" in this file to find all required customizations
# 2. Duplicate player sections for each additional device you have
# 3. Update input_select options to match your player entity IDs
# 4. Add more genres/filters to the input_select.media_filter_genre helper
# 5. Create Smart Collections in Plex for "Trending Now", "New HD", etc.
# 6. Test one player fully before adding more
# 7. See SETUP_GUIDE.md for detailed instructions
